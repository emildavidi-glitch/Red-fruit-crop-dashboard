<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OJ Intelligence Â· Orange Juice Concentrate Monitor</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=DM+Mono:wght@400;500&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<style>
:root {
  --orange:#E8650A; --orange-deep:#A03D00; --orange-light:#F5A623;
  --gold:#C8920A; --amber:#FFB347;
  --ink:#1A1208; --warm:#2D1F0A; --mid:#6B4E2A; --light:#B89060;
  --cream:#FDF8F0; --parchment:#F5EDD8; --border:#E8D8B8;
  --card:#FFFFFF; --shadow:0 2px 24px rgba(26,18,8,0.10);
  --green:#2E7D32; --red:#C62828; --neutral:#5D4037;
  --font-display:'DM Serif Display',serif;
  --font-mono:'DM Mono',monospace;
  --font-body:'DM Sans',sans-serif;
}
*{margin:0;padding:0;box-sizing:border-box;}
body{background:var(--cream);font-family:var(--font-body);color:var(--ink);min-height:100vh;}

/* HEADER */
.site-header{
  background:var(--warm);
  border-bottom:3px solid var(--orange);
  padding:0 40px;
  height:68px;
  display:flex;align-items:center;justify-content:space-between;
  position:sticky;top:0;z-index:100;
}
.brand{display:flex;align-items:center;gap:14px;}
.brand-icon{
  width:38px;height:38px;
  background:linear-gradient(135deg,var(--orange),var(--orange-light));
  border-radius:50%;display:flex;align-items:center;justify-content:center;
  font-size:20px;box-shadow:0 2px 8px rgba(232,101,10,0.4);
}
.brand-name{font-family:var(--font-display);font-size:1.3rem;color:var(--cream);letter-spacing:0.02em;}
.brand-sub{font-family:var(--font-mono);font-size:0.58rem;color:var(--light);letter-spacing:0.15em;text-transform:uppercase;margin-top:2px;}
.header-nav{display:flex;align-items:center;gap:16px;}
.back-link{
  font-family:var(--font-mono);font-size:0.68rem;color:var(--light);
  text-decoration:none;letter-spacing:0.08em;
  padding:6px 14px;border:1px solid #4A3018;border-radius:4px;
  transition:all .2s;
}
.back-link:hover{color:var(--cream);border-color:var(--orange);}
#live-time{font-family:var(--font-mono);font-size:0.65rem;color:var(--light);}

/* ALERT BANNER */
#market-signal-bar{
  padding:9px 40px;
  font-family:var(--font-mono);font-size:0.72rem;
  display:flex;align-items:center;gap:12px;
  border-bottom:1px solid var(--border);
}
#market-signal-bar.bullish{background:#E8F5E9;color:#1B5E20;}
#market-signal-bar.bearish{background:#FFEBEE;color:#B71C1C;}
#market-signal-bar.neutral{background:var(--parchment);color:var(--mid);}
.signal-dot{width:8px;height:8px;border-radius:50%;display:inline-block;}
.signal-dot.bullish{background:#2E7D32;}
.signal-dot.bearish{background:#C62828;}
.signal-dot.neutral{background:#8D6E63;}

/* MAIN LAYOUT */
main{max-width:1380px;margin:0 auto;padding:28px 40px;}

/* SECTION HEADERS */
.section-hd{
  font-family:var(--font-display);font-size:1.25rem;
  color:var(--warm);margin-bottom:16px;
  display:flex;align-items:center;gap:12px;
  padding-bottom:10px;border-bottom:2px solid var(--border);
}
.section-hd span{font-size:1rem;}

/* TOP PRICE ROW */
.price-row{display:grid;grid-template-columns:1.8fr 1fr 1fr 1fr 1fr;gap:14px;margin-bottom:28px;}
.price-hero{
  background:var(--warm);color:var(--cream);
  border-radius:12px;padding:22px 26px;
  box-shadow:var(--shadow);
  position:relative;overflow:hidden;
}
.price-hero::before{
  content:'ğŸŠ';font-size:80px;opacity:0.08;
  position:absolute;right:-10px;top:-10px;
}
.price-hero-label{font-family:var(--font-mono);font-size:0.6rem;text-transform:uppercase;letter-spacing:.15em;color:var(--light);margin-bottom:6px;}
.price-hero-val{font-family:var(--font-display);font-size:3rem;line-height:1;color:var(--cream);}
.price-hero-unit{font-family:var(--font-mono);font-size:0.75rem;color:var(--orange-light);margin-top:4px;}
.price-hero-change{
  font-family:var(--font-mono);font-size:0.85rem;font-weight:500;
  margin-top:10px;padding:4px 10px;border-radius:4px;display:inline-block;
}
.price-hero-change.up{background:rgba(46,125,50,0.2);color:#81C784;}
.price-hero-change.down{background:rgba(198,40,40,0.2);color:#EF9A9A;}

.stat-card{
  background:var(--card);border-radius:10px;padding:18px 20px;
  box-shadow:var(--shadow);border:1px solid var(--border);
}
.stat-label{font-family:var(--font-mono);font-size:0.58rem;text-transform:uppercase;letter-spacing:.12em;color:var(--light);margin-bottom:6px;}
.stat-val{font-family:var(--font-display);font-size:1.4rem;color:var(--warm);}
.stat-sub{font-family:var(--font-mono);font-size:0.62rem;color:var(--mid);margin-top:5px;}
.stat-bar{height:5px;background:#eee;border-radius:3px;margin-top:8px;overflow:hidden;}
.stat-bar-fill{height:100%;border-radius:3px;background:linear-gradient(90deg,var(--orange),var(--orange-light));}

/* CHART SECTION */
.chart-grid{display:grid;grid-template-columns:2fr 1fr;gap:18px;margin-bottom:28px;}
.chart-card{background:var(--card);border-radius:12px;box-shadow:var(--shadow);border:1px solid var(--border);padding:22px;}
.chart-wrap{position:relative;height:260px;margin-top:16px;}
.tradingview-wrap{position:relative;height:340px;margin-top:16px;border-radius:8px;overflow:hidden;}

/* TECHNICAL ANALYSIS */
.tech-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:14px;}
.tech-item{
  background:var(--parchment);border-radius:8px;padding:12px 14px;
  border-left:3px solid var(--border);
}
.tech-item.support{border-left-color:var(--green);}
.tech-item.resistance{border-left-color:var(--red);}
.tech-item.signal{border-left-color:var(--orange);}
.tech-label{font-family:var(--font-mono);font-size:0.55rem;text-transform:uppercase;letter-spacing:.1em;color:var(--light);margin-bottom:4px;}
.tech-val{font-family:var(--font-mono);font-size:0.9rem;font-weight:500;color:var(--warm);}
.tech-note{font-size:0.65rem;color:var(--mid);margin-top:3px;}

/* OUTLOOK SIGNAL */
.outlook-card{
  border-radius:12px;padding:22px;box-shadow:var(--shadow);
  border:2px solid var(--border);
}
.outlook-card.bullish{background:linear-gradient(135deg,#E8F5E9,#F1F8E9);border-color:#A5D6A7;}
.outlook-card.bearish{background:linear-gradient(135deg,#FFEBEE,#FFF3E0);border-color:#FFCDD2;}
.outlook-card.neutral{background:var(--parchment);border-color:var(--border);}
.outlook-badge{
  display:inline-block;padding:5px 14px;border-radius:20px;
  font-family:var(--font-mono);font-size:0.7rem;font-weight:500;
  letter-spacing:.08em;text-transform:uppercase;margin-bottom:12px;
}
.outlook-badge.bullish{background:#2E7D32;color:white;}
.outlook-badge.bearish{background:#C62828;color:white;}
.outlook-badge.neutral{background:#5D4037;color:white;}
.outlook-title{font-family:var(--font-display);font-size:1.2rem;color:var(--warm);margin-bottom:8px;}
.outlook-text{font-size:0.78rem;color:var(--mid);line-height:1.6;}
.outlook-factors{margin-top:14px;}
.factor-row{display:flex;align-items:flex-start;gap:8px;margin-bottom:7px;font-size:0.74rem;color:var(--ink);}
.factor-icon{flex-shrink:0;font-size:0.85rem;}

/* BRAZIL SECTION */
.brazil-grid{display:grid;grid-template-columns:1fr 1fr;gap:18px;margin-bottom:28px;}
.fundecitrus-card{background:var(--card);border-radius:12px;box-shadow:var(--shadow);border:1px solid var(--border);padding:22px;}
.forecast-timeline{margin-top:16px;}
.forecast-row{
  display:flex;align-items:center;gap:12px;
  padding:10px 0;border-bottom:1px solid var(--border);
}
.forecast-row:last-child{border-bottom:none;}
.forecast-date{font-family:var(--font-mono);font-size:0.62rem;color:var(--light);width:70px;flex-shrink:0;}
.forecast-bar-wrap{flex:1;height:8px;background:#eee;border-radius:4px;overflow:hidden;}
.forecast-bar-fill{height:100%;border-radius:4px;transition:width .6s;}
.forecast-fill-may{background:var(--orange-light);}
.forecast-fill-sep{background:var(--orange);}
.forecast-fill-dec{background:var(--orange-deep);}
.forecast-fill-feb{background:var(--red);}
.forecast-val{font-family:var(--font-mono);font-size:0.72rem;font-weight:500;color:var(--warm);width:80px;text-align:right;flex-shrink:0;}
.forecast-delta{font-family:var(--font-mono);font-size:0.6rem;color:var(--red);width:50px;text-align:right;flex-shrink:0;}

.greening-meter{margin-top:16px;}
.meter-row{display:flex;align-items:center;justify-content:space-between;margin-bottom:6px;}
.meter-label{font-family:var(--font-mono);font-size:0.62rem;color:var(--mid);}
.meter-val{font-family:var(--font-mono);font-size:0.72rem;font-weight:500;}
.meter-bar{height:10px;background:#eee;border-radius:5px;overflow:hidden;margin-bottom:12px;}
.meter-fill{height:100%;border-radius:5px;background:linear-gradient(90deg,#FFA726,#E53935);}
.kpi-row{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:14px;}
.kpi{background:var(--parchment);border-radius:8px;padding:10px 12px;text-align:center;}
.kpi-val{font-family:var(--font-display);font-size:1.1rem;color:var(--warm);}
.kpi-label{font-family:var(--font-mono);font-size:0.55rem;text-transform:uppercase;letter-spacing:.08em;color:var(--light);margin-top:3px;}

/* WEATHER SECTION */
.weather-section{margin-bottom:28px;}
.region-cards{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:14px;margin-top:16px;}
.wx-card{
  background:var(--card);border-radius:10px;box-shadow:var(--shadow);
  border:1px solid var(--border);overflow:hidden;transition:transform .2s,box-shadow .2s;
}
.wx-card:hover{transform:translateY(-2px);box-shadow:0 8px 28px rgba(26,18,8,0.15);}
.wx-card-hd{
  padding:12px 16px 10px;
  background:var(--parchment);border-bottom:1px solid var(--border);
  display:flex;justify-content:space-between;align-items:flex-start;
}
.wx-region{font-family:var(--font-display);font-size:.9rem;color:var(--warm);}
.wx-country{font-family:var(--font-mono);font-size:0.55rem;color:var(--light);text-transform:uppercase;letter-spacing:.1em;margin-top:2px;}
.wx-badge{
  padding:2px 8px;border-radius:8px;
  font-family:var(--font-mono);font-size:0.55rem;
  font-weight:500;text-transform:uppercase;color:white;
}
.wx-badge.heat{background:#E53935;}
.wx-badge.drought{background:#F57F17;}
.wx-badge.good{background:#388E3C;}
.wx-badge.freeze{background:#1565C0;}
.wx-badge.watch{background:#F39C12;}
.wx-body{padding:14px 16px;}
.wx-stats{display:grid;grid-template-columns:repeat(3,1fr);gap:6px;margin-bottom:10px;}
.wx-stat{text-align:center;background:var(--parchment);border-radius:6px;padding:6px 4px;}
.wx-stat-val{font-family:var(--font-mono);font-size:.85rem;font-weight:500;}
.wx-stat-lbl{font-size:0.52rem;color:var(--light);text-transform:uppercase;margin-top:2px;}
.wx-note{font-size:0.68rem;color:var(--mid);line-height:1.4;margin-top:6px;}
.wx-forecast{display:flex;gap:4px;margin-top:10px;padding-top:10px;border-top:1px solid var(--border);}
.wx-day{flex:1;text-align:center;padding:4px 2px;border-radius:4px;background:var(--parchment);}
.wx-day.hot{background:#FFF3E0;border:1px solid #FFCC80;}
.wx-day.cold{background:#E3F2FD;border:1px solid #90CAF9;}
.wx-day-name{font-family:var(--font-mono);font-size:0.5rem;color:var(--light);text-transform:uppercase;}
.wx-day-icon{font-size:.8rem;margin:2px 0;}
.wx-day-temp{font-family:var(--font-mono);font-size:.6rem;font-weight:500;}
.loading-spinner{display:flex;align-items:center;justify-content:center;padding:30px;color:var(--mid);font-family:var(--font-mono);font-size:0.78rem;}
.spin{width:16px;height:16px;border:2px solid var(--border);border-top-color:var(--orange);border-radius:50%;animation:spin .8s linear infinite;margin-right:8px;}
@keyframes spin{to{transform:rotate(360deg)}}

/* NEWS */
.news-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:14px;margin-top:16px;}
.news-card{
  background:var(--card);border-radius:10px;box-shadow:var(--shadow);
  border:1px solid var(--border);overflow:hidden;
  transition:transform .2s,box-shadow .2s;
}
.news-card:hover{transform:translateY(-2px);box-shadow:0 8px 28px rgba(26,18,8,0.15);}
.news-card.high-impact{border-left:4px solid var(--red);}
.news-card-hd{padding:10px 14px 8px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;}
.news-tag{font-family:var(--font-mono);font-size:0.55rem;background:#FFF3E0;color:var(--orange-deep);border:1px solid #FFCC80;padding:2px 8px;border-radius:8px;}
.news-src{font-family:var(--font-mono);font-size:0.55rem;color:var(--light);}
.news-body{padding:12px 14px;}
.news-title{font-family:var(--font-display);font-size:0.88rem;line-height:1.35;margin-bottom:6px;color:var(--warm);}
.news-summary{font-size:0.72rem;color:var(--mid);line-height:1.5;}
.news-ft{padding:8px 14px;border-top:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;}
.news-date{font-family:var(--font-mono);font-size:0.55rem;color:var(--light);}
.news-link{font-family:var(--font-mono);font-size:0.6rem;color:var(--orange);text-decoration:none;}
.news-link:hover{text-decoration:underline;}

/* FOOTER */
footer{background:var(--warm);color:var(--light);padding:18px 40px;font-family:var(--font-mono);font-size:0.62rem;display:flex;justify-content:space-between;margin-top:20px;}

@media(max-width:900px){
  main,footer,.site-header,#market-signal-bar{padding-left:16px;padding-right:16px;}
  .price-row{grid-template-columns:1fr 1fr;}
  .price-hero{grid-column:1/-1;}
  .chart-grid,.brazil-grid{grid-template-columns:1fr;}
  .tech-grid{grid-template-columns:1fr 1fr;}
}
</style>
</head>
<body>

<header class="site-header">
  <div class="brand">
    <div class="brand-icon">ğŸŠ</div>
    <div>
      <div class="brand-name">OJ Intelligence</div>
      <div class="brand-sub">Orange Juice Concentrate Monitor</div>
    </div>
  </div>
  <div class="header-nav">
    <span id="live-time"></span>
    <a href="index.html" class="back-link">â† Back to Red Fruit DSS</a>
  </div>
</header>

<div id="market-signal-bar" class="neutral">
  <span class="signal-dot neutral" id="signal-dot"></span>
  <span id="signal-text">Calculating market outlook...</span>
</div>

<main>

  <!-- â•â•â•â•â•â•â• PRICE PANEL â•â•â•â•â•â•â• -->
  <div class="section-hd">
    <span>ğŸ“ˆ</span> FCOJ Futures -- ICE Exchange (USX/lb)
    <span id="price-freshness" style="font-family:var(--font-mono);font-size:0.6rem;font-weight:400;color:var(--light);margin-left:8px">Loading...</span>
  </div>
  <div class="price-row">
    <div class="price-hero">
      <div class="price-hero-label" id="price-label">FCOJ Front Month -- Live Quote</div>
      <div class="price-hero-val" id="price-main" style="font-size:2.4rem">--</div>
      <div class="price-hero-unit">USX per pound Â· ICE Futures U.S. (OJ=F)</div>
      <div class="price-hero-change" id="price-change" style="background:rgba(255,255,255,0.1);color:#ccc">Loading live price...</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">52-Week Range</div>
      <div class="stat-val" id="price-52low">--</div>
      <div class="stat-sub">Low Â· <strong id="price-52high">--</strong> High</div>
      <div class="stat-bar"><div class="stat-bar-fill" id="price-range-bar" style="width:0%"></div></div>
      <div class="stat-sub" id="price-range-pos" style="margin-top:6px">--</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Day Range</div>
      <div class="stat-val" id="price-daylow">--</div>
      <div class="stat-sub">Low Â· <strong id="price-dayhigh">--</strong> High</div>
      <div class="stat-bar"><div class="stat-bar-fill" id="price-day-bar" style="width:50%"></div></div>
      <div class="stat-sub" id="price-vs-prev" style="margin-top:6px">vs prev close: --</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Previous Close</div>
      <div class="stat-val" id="price-prevclose">--</div>
      <div class="stat-sub" id="price-open">Open: --</div>
      <div class="stat-sub" id="price-volume" style="margin-top:4px">Volume: --</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Market Status</div>
      <div class="stat-val" id="price-market-state" style="font-size:1rem">--</div>
      <div class="stat-sub" id="price-exchange">ICE Futures U.S.</div>
      <div class="stat-sub" style="margin-top:4px;font-size:0.6rem;color:var(--light)">
        Via Yahoo Finance Â· ~15min delayed<br>
        <span id="price-updated">Not yet loaded</span>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â• CHART + TECHNICALS â•â•â•â•â•â•â• -->
  <div class="chart-grid">
    <div class="chart-card" style="padding:0;overflow:hidden;">
      <div style="padding:16px 20px 0;font-family:var(--font-display);font-size:1rem;color:var(--warm);display:flex;align-items:center;gap:8px;">
        <span>ğŸ“Š</span> FCOJ Live Chart Â· TradingView
        <span style="font-family:var(--font-mono);font-size:0.58rem;color:var(--light);font-weight:400">ICE:OJ1! Â· Real-time</span>
      </div>
      <div class="tradingview-wrap" id="tv-wrap">
        <iframe
          src="https://s.tradingview.com/widgetembed/?frameElementId=tv_oj&symbol=OJ1!&interval=D&hidesidetoolbar=0&symboledit=0&saveimage=0&toolbarbg=f5edd8&studies=RSI%40tv-basicstudies%1FMACD%40tv-basicstudies&theme=light&style=1&timezone=Europe%2FBerlin&withdateranges=1&showpopupbutton=1&locale=en"
          style="width:100%;height:100%;border:none;"
          allowtransparency="true"
          frameborder="0"
          scrolling="no">
        </iframe>
      </div>
    </div>
    <div class="chart-card">
      <div class="section-hd" style="border:none;margin-bottom:8px;padding-bottom:0;font-size:1rem">
        <span>ğŸ¯</span> Technical Levels Â· Today
      </div>
      <div class="tech-grid">
        <div class="tech-item resistance">
          <div class="tech-label">Resistance 3</div>
          <div class="tech-val">228.00Â¢</div>
          <div class="tech-note">Strong upper level</div>
        </div>
        <div class="tech-item resistance">
          <div class="tech-label">Resistance 2</div>
          <div class="tech-val">220.00Â¢</div>
          <div class="tech-note">Near-term cap</div>
        </div>
        <div class="tech-item resistance">
          <div class="tech-label">Resistance 1</div>
          <div class="tech-val">211.00Â¢</div>
          <div class="tech-note">First hurdle</div>
        </div>
        <div class="tech-item signal">
          <div class="tech-label">Current Price</div>
          <div class="tech-val" style="color:var(--orange)" id="tech-current-price">--Â¢</div>
          <div class="tech-note" id="tech-price-note">Loading...</div>
        </div>
        <div class="tech-item support">
          <div class="tech-label">Support 1</div>
          <div class="tech-val">186.00Â¢</div>
          <div class="tech-note">Strong floor</div>
        </div>
        <div class="tech-item support">
          <div class="tech-label">Support 2</div>
          <div class="tech-val">163.00Â¢</div>
          <div class="tech-note">Major support</div>
        </div>
        <div class="tech-item support">
          <div class="tech-label">Support 3</div>
          <div class="tech-val">151.00Â¢</div>
          <div class="tech-note">Deep support</div>
        </div>
        <div class="tech-item signal">
          <div class="tech-label">Trend (daily)</div>
          <div class="tech-val">Mixed/â†‘</div>
          <div class="tech-note">Short-term up</div>
        </div>
        <div class="tech-item signal">
          <div class="tech-label">Signal</div>
          <div class="tech-val" style="color:var(--green)">BUY</div>
          <div class="tech-note">Investing.com</div>
        </div>
      </div>
      <div style="margin-top:14px;padding:10px 12px;background:var(--parchment);border-radius:8px;font-size:0.68rem;color:var(--mid);line-height:1.5;">
        <strong style="color:var(--warm)">Today's Market Commentary (Jack Scoville, Feb 19):</strong><br>
        Florida harvest active, wrapping up. Cold January/early February may have caused some tree damage -- frozen fruit being sent to processors. Brazil weather good. Trends mixed to up on daily charts. Market feels demand remains weak after last year's high prices.
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â• OUTLOOK SIGNAL â•â•â•â•â•â•â• -->
  <div id="outlook-card" class="outlook-card neutral" style="margin-bottom:28px">
    <span class="outlook-badge neutral" id="outlook-badge">NEUTRAL</span>
    <div class="outlook-title" id="outlook-title">Market Outlook: Cautiously Neutral</div>
    <div class="outlook-text" id="outlook-text"></div>
    <div class="outlook-factors" id="outlook-factors"></div>
  </div>

  <!-- â•â•â•â•â•â•â• BRAZIL SUPPLY â•â•â•â•â•â•â• -->
  <div class="section-hd"><span>ğŸ‡§ğŸ‡·</span> Brazil Supply Intelligence Â· Fundecitrus 2025/26 Season</div>
  <div class="brazil-grid">
    <div class="fundecitrus-card">
      <div style="font-family:var(--font-mono);font-size:0.62rem;text-transform:uppercase;letter-spacing:.1em;color:var(--light);margin-bottom:12px;">Crop Forecast Revisions -- SÃ£o Paulo Citrus Belt</div>
      <div class="forecast-timeline">
        <div class="forecast-row">
          <div class="forecast-date">May 2025</div>
          <div class="forecast-bar-wrap"><div class="forecast-bar-fill forecast-fill-may" style="width:100%"></div></div>
          <div class="forecast-val">314.60M boxes</div>
          <div class="forecast-delta">baseline</div>
        </div>
        <div class="forecast-row">
          <div class="forecast-date">Sep 2025</div>
          <div class="forecast-bar-wrap"><div class="forecast-bar-fill forecast-fill-sep" style="width:97.5%"></div></div>
          <div class="forecast-val">306.74M boxes</div>
          <div class="forecast-delta">âˆ’2.5%</div>
        </div>
        <div class="forecast-row">
          <div class="forecast-date">Dec 2025</div>
          <div class="forecast-bar-wrap"><div class="forecast-bar-fill forecast-fill-dec" style="width:93.7%"></div></div>
          <div class="forecast-val">294.81M boxes</div>
          <div class="forecast-delta">âˆ’6.3%</div>
        </div>
        <div class="forecast-row">
          <div class="forecast-date">Feb 2026 â˜…</div>
          <div class="forecast-bar-wrap"><div class="forecast-bar-fill forecast-fill-feb" style="width:91%"></div></div>
          <div class="forecast-val">~286M est.</div>
          <div class="forecast-delta">~âˆ’9%</div>
        </div>
      </div>
      <div style="font-size:0.65rem;color:var(--mid);margin-top:12px;padding:8px 10px;background:var(--parchment);border-radius:6px;line-height:1.5;">
        â˜… Feb 10, 2026 update: Drop rate maintained at 23% -- highest in 11 harvests. Rainfall 10% below historical average. Fruit weight 1g below projection. Final estimate due April 10, 2026.
      </div>
      <div class="kpi-row">
        <div class="kpi">
          <div class="kpi-val" style="color:var(--red)">23%</div>
          <div class="kpi-label">Fruit Drop Rate</div>
        </div>
        <div class="kpi">
          <div class="kpi-val" style="color:var(--orange)">âˆ’10%</div>
          <div class="kpi-label">Rainfall vs Avg</div>
        </div>
        <div class="kpi">
          <div class="kpi-val">153g</div>
          <div class="kpi-label">Avg Fruit Weight</div>
        </div>
      </div>
    </div>

    <div class="fundecitrus-card">
      <div style="font-family:var(--font-mono);font-size:0.62rem;text-transform:uppercase;letter-spacing:.1em;color:var(--light);margin-bottom:14px;">Citrus Greening Disease (HLB) Progression</div>
      <div class="greening-meter">
        <div class="meter-row">
          <div class="meter-label">2023 incidence</div>
          <div class="meter-val" style="color:var(--orange-light)">38.1%</div>
        </div>
        <div class="meter-bar"><div class="meter-fill" style="width:38.1%"></div></div>
        <div class="meter-row">
          <div class="meter-label">2024 incidence</div>
          <div class="meter-val" style="color:var(--orange)">44.4%</div>
        </div>
        <div class="meter-bar"><div class="meter-fill" style="width:44.4%"></div></div>
        <div class="meter-row">
          <div class="meter-label">2025 incidence</div>
          <div class="meter-val" style="color:var(--red)">47.6%</div>
        </div>
        <div class="meter-bar"><div class="meter-fill" style="width:47.6%"></div></div>
        <div class="meter-row">
          <div class="meter-label">Severity (2025)</div>
          <div class="meter-val" style="color:var(--red)">22.7%</div>
        </div>
        <div class="meter-bar"><div class="meter-fill" style="width:22.7%"></div></div>
      </div>
      <div style="font-size:0.67rem;color:var(--mid);margin-top:12px;line-height:1.5;padding:8px 10px;background:#FFF3E0;border-radius:6px;border-left:3px solid var(--orange);">
        <strong>Productivity impact:</strong> 26.5% of infected trees show symptoms in &gt;75% of canopy. Greening + drought together reduce productive potential by approximately <strong>35%</strong>. Most affected areas: Limeira, Porto Ferreira, AvarÃ© (&gt;60% incidence).
      </div>
      <div class="kpi-row" style="margin-top:12px;">
        <div class="kpi">
          <div class="kpi-val" style="color:var(--red)">47.6%</div>
          <div class="kpi-label">Trees Infected</div>
        </div>
        <div class="kpi">
          <div class="kpi-val" style="color:var(--orange)">âˆ’35%</div>
          <div class="kpi-label">Yield Reduction</div>
        </div>
        <div class="kpi">
          <div class="kpi-val">Apr 10</div>
          <div class="kpi-label">Final Forecast</div>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â• WEATHER â•â•â•â•â•â•â• -->
  <div class="section-hd" style="margin-bottom:4px"><span>ğŸŒ¡</span> Live Weather Â· Key Citrus Regions</div>
  <div style="font-family:var(--font-mono);font-size:0.65rem;color:var(--light);margin-bottom:14px;">Open-Meteo live data Â· Heat stress &gt;35Â°C damaging Â· Drought = precip &lt;1mm/day Â· Freeze risk &lt;2Â°C</div>
  <div id="wx-grid" class="region-cards">
    <div class="loading-spinner"><div class="spin"></div>Loading weather data...</div>
  </div>

  <!-- â•â•â•â•â•â•â• NEWS â•â•â•â•â•â•â• -->
  <div class="section-hd" style="margin-top:28px"><span>ğŸ“°</span> Orange Juice Market News</div>
  <div id="oj-news" class="news-grid">
    <div class="loading-spinner"><div class="spin"></div>Loading news...</div>
  </div>

</main>

<footer>
  <div>ğŸŠ OJ Intelligence Â· ICE FCOJ-A Futures Â· Open-Meteo Â· Fundecitrus 2025/26</div>
  <div>Price data delayed -- not for trading purposes Â· Updated: <span id="footer-time"></span></div>
</footer>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  CITRUS REGIONS -- heat/drought monitoring
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const CITRUS_REGIONS = [
  { id:'brazil-saopaulo', name:'SÃ£o Paulo Citrus Belt', country:'Brazil', flag:'ğŸ‡§ğŸ‡·',
    lat:-21.8, lon:-48.2, role:'Primary Supply (80% of world NFC exports)',
    heatThreshold:35, droughtDays:3 },
  { id:'brazil-triangulo', name:'TriÃ¢ngulo Mineiro', country:'Brazil', flag:'ğŸ‡§ğŸ‡·',
    lat:-18.9, lon:-48.3, role:'Secondary SÃ£o Paulo Belt (~25M boxes)',
    heatThreshold:35, droughtDays:3 },
  { id:'florida-usa', name:'Florida Citrus Belt', country:'USA', flag:'ğŸ‡ºğŸ‡¸',
    lat:27.9, lon:-81.5, role:'US domestic NFC -- freeze risk Nov--Mar',
    heatThreshold:38, droughtDays:5 },
  { id:'egypt-nile', name:'Nile Delta (Beheira)', country:'Egypt', flag:'ğŸ‡ªğŸ‡¬',
    lat:30.8, lon:30.5, role:'Winter NFC supply to Europe',
    heatThreshold:38, droughtDays:7 },
  { id:'spain-andalusia', name:'Andalusia / Valencia', country:'Spain', flag:'ğŸ‡ªğŸ‡¸',
    lat:37.5, lon:-0.5, role:'European NFC production',
    heatThreshold:36, droughtDays:5 },
  { id:'southafrica-wc', name:'Western Cape', country:'South Africa', flag:'ğŸ‡¿ğŸ‡¦',
    lat:-33.9, lon:18.9, role:'Southern Hemisphere -- May--Sep supply',
    heatThreshold:38, droughtDays:6 },
];

const WX_CODES = {0:'â˜€ï¸',1:'ğŸŒ¤',2:'â›…',3:'â˜ï¸',45:'ğŸŒ«',51:'ğŸŒ¦',53:'ğŸŒ¦',61:'ğŸŒ§',63:'ğŸŒ§',71:'ğŸŒ¨',80:'ğŸŒ¦',95:'â›ˆ'};
const DAYS = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];

async function fetchWX(r) {
  const url = `https://api.open-meteo.com/v1/forecast?latitude=${r.lat}&longitude=${r.lon}&current=temperature_2m,weathercode,windspeed_10m,precipitation&daily=temperature_2m_max,temperature_2m_min,weathercode,precipitation_sum&timezone=auto&forecast_days=7`;
  const controller = new AbortController();
  const timeout = setTimeout(() => controller.abort(), 8000); // 8s timeout
  const res = await fetch(url, { signal: controller.signal });
  clearTimeout(timeout);
  if (!res.ok) throw new Error();
  const d = await res.json();
  return {
    temp: Math.round(d.current.temperature_2m*10)/10,
    precip: Math.round(d.current.precipitation*10)/10,
    wind: Math.round(d.current.windspeed_10m),
    code: d.current.weathercode,
    max7: d.daily.temperature_2m_max.map(t=>Math.round(t)),
    min7: d.daily.temperature_2m_min.map(t=>Math.round(t)),
    precip7: d.daily.precipitation_sum,
    codes7: d.daily.weathercode,
    dates7: d.daily.time,
    max7d: Math.max(...d.daily.temperature_2m_max),
    totalPrecip7: d.daily.precipitation_sum.reduce((s,v)=>s+v,0),
  };
}

function assessCitrusRisk(r, wx) {
  if (!wx) return { badge:'watch', label:'No data' };
  const heatDays = wx.max7.filter(t => t >= r.heatThreshold).length;
  const dryDays = wx.precip7.filter(p => p < 0.5).length;
  const freezeDays = wx.min7.filter(t => t <= 2).length;
  if (freezeDays >= 2) return { badge:'freeze', label:'Freeze Risk' };
  if (heatDays >= 3) return { badge:'heat', label:'Heat Stress' };
  if (dryDays >= 5) return { badge:'drought', label:'Drought' };
  if (heatDays >= 1 || dryDays >= 3) return { badge:'watch', label:'Watch' };
  return { badge:'good', label:'Favourable' };
}

async function loadWeather() {
  const results = await Promise.all(CITRUS_REGIONS.map(async r => {
    try { return { r, wx: await fetchWX(r) }; }
    catch { return { r, wx: null }; }
  }));

  document.getElementById('wx-grid').innerHTML = results.map(({r, wx}) => {
    if (!wx) return `<div class="wx-card">
      <div class="wx-card-hd"><div><div class="wx-region">${r.flag} ${r.name}</div><div class="wx-country">${r.country}</div></div><span class="wx-badge watch">N/A</span></div>
      <div class="wx-body" style="color:#aaa;font-size:0.75rem;padding:14px 16px">Weather data temporarily unavailable -- retrying in 30 min.</div></div>`;

    const risk = assessCitrusRisk(r, wx);
    const forecast = wx.dates7.slice(0,5).map((dt,i) => {
      const hot = wx.max7[i] >= r.heatThreshold;
      const cold = wx.min7[i] <= 4;
      const dn = DAYS[new Date(dt+'T12:00:00').getDay()];
      return `<div class="wx-day${hot?' hot':cold?' cold':''}">
        <div class="wx-day-name">${dn}</div>
        <div class="wx-day-icon">${WX_CODES[wx.codes7[i]]||'ğŸŒ¡'}</div>
        <div class="wx-day-temp">${wx.max7[i]}Â°/${wx.min7[i]}Â°</div>
      </div>`;
    }).join('');

    return `<div class="wx-card">
      <div class="wx-card-hd">
        <div><div class="wx-region">${r.flag} ${r.name}</div><div class="wx-country">${r.country}</div></div>
        <span class="wx-badge ${risk.badge}">${risk.label}</span>
      </div>
      <div class="wx-body">
        <div class="wx-stats">
          <div class="wx-stat"><div class="wx-stat-val">${wx.temp}Â°C</div><div class="wx-stat-lbl">Now</div></div>
          <div class="wx-stat"><div class="wx-stat-val">${wx.max7d}Â°C</div><div class="wx-stat-lbl">Max 7d</div></div>
          <div class="wx-stat"><div class="wx-stat-val">${Math.round(wx.totalPrecip7)}mm</div><div class="wx-stat-lbl">Rain 7d</div></div>
        </div>
        <div class="wx-note">ğŸ“ ${r.role}</div>
        <div class="wx-forecast">${forecast}</div>
      </div>
    </div>`;
  }).join('');

  buildOutlook(results);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  PRICE OUTLOOK SIGNAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildOutlook(wxResults, livePrice, priceChange, priceChangePct) {
  const factors = [];
  let score = 0;

  // Price trend -- use live data if available, else static context
  if (livePrice != null && priceChange != null) {
    const p = livePrice.toFixed(2);
    const c = priceChange.toFixed(2);
    const pct = priceChangePct ? priceChangePct.toFixed(2) : '?';
    if (priceChange >= 0) {
      factors.push({ icon:'ğŸ“ˆ', text:`Live price ${p}Â¢ (+${c}, +${pct}% today). Positive session -- watch resistance at 211Â¢.`, bullish:true });
      score += 1;
    } else {
      factors.push({ icon:'ğŸ“‰', text:`Live price ${p}Â¢ (${c}, ${pct}% today). Negative session -- demand weakness continuing.`, bullish:false });
      score -= 1;
    }
    if (livePrice < 186) {
      factors.push({ icon:'âš ï¸', text:`Price ${p}Â¢ has broken below key support 186Â¢ -- bearish signal, next support 163Â¢.`, bullish:false });
      score -= 2;
    } else if (livePrice > 211) {
      factors.push({ icon:'ğŸš€', text:`Price ${p}Â¢ has broken above resistance 211Â¢ -- bullish breakout signal.`, bullish:true });
      score += 2;
    }
  } else {
    factors.push({ icon:'ğŸ“‰', text:'Price down ~42% YoY: demand destruction after 2024 highs is dominant force.', bullish:false });
    score -= 2;
  }

  // Brazil supply: greening + drought = structural decline
  factors.push({ icon:'ğŸŠ', text:'Brazil 2025/26: forecast cut 4 times, now ~286M boxes est. Greening affects 47.6% of trees. Drop rate 23% -- worst in 11 years.', bullish:false });
  score -= 1;

  // Florida
  factors.push({ icon:'â„ï¸', text:'Florida: January cold may have caused tree damage. Frozen fruit going to processors. Harvest wrapping up. Next crop at risk.', bullish:false });
  score -= 1;

  // Demand
  factors.push({ icon:'ğŸ“¦', text:'Demand remains weak -- consumers adjusted to high prices. Market expects demand suppression to continue near-term.', bullish:false });
  score -= 1;

  // Technical
  factors.push({ icon:'ğŸ¯', text:'Technical: Support 186Â¢ holding. Resistance at 211Â¢. A break above 211 would be bullish signal.', bullish:null });

  // Weather stress in Brazil
  const brazilWX = wxResults ? wxResults.find(d => d.r.id === 'brazil-saopaulo') : null;
  if (brazilWX?.wx) {
    const risk = assessCitrusRisk(brazilWX.r, brazilWX.wx);
    if (risk.badge === 'heat' || risk.badge === 'drought') {
      factors.push({ icon:'ğŸŒ¡', text:`Brazil citrus belt showing ${risk.label} conditions -- additional supply pressure possible.`, bullish:false });
      score -= 1;
    } else if (risk.badge === 'good') {
      factors.push({ icon:'ğŸŒ§', text:'Brazil weather currently favourable for crop development.', bullish:true });
      score += 1;
    }
  }

  let direction, title, text;
  if (score <= -3) {
    direction = 'bearish';
    title = 'Outlook: Bearish -- Demand Destruction Dominant';
    text = 'Despite historically tight supply from Brazil and Florida, weak consumer demand after 2024 record highs is keeping prices suppressed. The structural supply problem (greening, drought) supports a long-term floor, but near-term price direction is down or sideways until demand recovers.';
  } else if (score >= 1) {
    direction = 'bullish';
    title = 'Outlook: Bullish -- Supply Constraints Taking Hold';
    text = 'Supply-side pressure from Brazil greening and Florida weather damage is beginning to outweigh demand weakness. Technical indicators turning positive.';
  } else {
    direction = 'neutral';
    title = 'Outlook: Neutral -- Supply vs Demand in Balance';
    text = 'Tight supply from Brazil (greening, drought) is offset by weak global demand after 2024 record prices. Watch for Brazil rainfall data and US demand indicators as key catalysts.';
  }

  const card = document.getElementById('outlook-card');
  const badge = document.getElementById('outlook-badge');
  const titleEl = document.getElementById('outlook-title');
  const textEl = document.getElementById('outlook-text');
  const factorsEl = document.getElementById('outlook-factors');

  card.className = `outlook-card ${direction}`;
  badge.className = `outlook-badge ${direction}`;
  badge.textContent = direction.toUpperCase();
  titleEl.textContent = title;
  textEl.textContent = text;
  factorsEl.innerHTML = factors.map(f =>
    `<div class="factor-row">
      <span class="factor-icon">${f.icon}</span>
      <span style="color:${f.bullish===true?'var(--green)':f.bullish===false?'var(--red)':'var(--ink)'}">${f.text}</span>
    </div>`
  ).join('');

  // Update signal bar
  const bar = document.getElementById('market-signal-bar');
  const dot = document.getElementById('signal-dot');
  const txt = document.getElementById('signal-text');
  bar.className = direction;
  dot.className = `signal-dot ${direction}`;
  const msgs = {
    bullish:'ğŸ“ˆ MARKET SIGNAL: BULLISH -- Supply constraints outweighing demand weakness. Watch for breakout above 211Â¢.',
    bearish:'ğŸ“‰ MARKET SIGNAL: BEARISH -- Demand destruction dominant. Price likely range-bound 163--211Â¢ near-term.',
    neutral:'âš–ï¸ MARKET SIGNAL: NEUTRAL -- Supply tightness vs weak demand. Key levels: Support 186Â¢ / Resistance 211Â¢.',
  };
  txt.textContent = msgs[direction];
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  LIVE PRICE â€” Yahoo Finance (OJ=F, ~15min delayed)
//  Updates every 5 minutes automatically
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let lastKnownPrice = null;

async function fetchLivePrice() {
  // Yahoo Finance v8 API -- no key required, ~15min delayed
  // Use allorigins.win as CORS proxy since GitHub Pages is a browser context
  const ticker = 'OJ=F';
  const proxyUrl = `https://query1.finance.yahoo.com/v8/finance/chart/${ticker}?interval=1d&range=1d`;
  const corsProxy = `https://corsproxy.io/?${encodeURIComponent(proxyUrl)}`;

  try {
    const controller = new AbortController();
    const timeout = setTimeout(() => controller.abort(), 10000);
    const res = await fetch(corsProxy, { signal: controller.signal });
    clearTimeout(timeout);

    if (!res.ok) throw new Error(`HTTP ${res.status}`);
    const data = await res.json();
    const meta = data?.chart?.result?.[0]?.meta;
    if (!meta) throw new Error('No meta in response');

    const price     = meta.regularMarketPrice;
    const prevClose = meta.chartPreviousClose || meta.previousClose;
    const dayHigh   = meta.regularMarketDayHigh;
    const dayLow    = meta.regularMarketDayLow;
    const weekHigh  = meta.fiftyTwoWeekHigh;
    const weekLow   = meta.fiftyTwoWeekLow;
    const volume    = meta.regularMarketVolume;
    const open      = meta.regularMarketOpen;
    const state     = meta.marketState; // REGULAR, PRE, POST, CLOSED

    if (!price) throw new Error('Price missing');
    lastKnownPrice = price;
    renderLivePrice({ price, prevClose, dayHigh, dayLow, weekHigh, weekLow, volume, open, state });
    return price;

  } catch(e) {
    console.warn('Yahoo Finance fetch failed:', e.message);
    // Try backup proxy
    try {
      const backup = `https://api.allorigins.win/get?url=${encodeURIComponent(
        `https://query2.finance.yahoo.com/v8/finance/chart/OJ=F?interval=1d&range=1d`
      )}`;
      const res2 = await fetch(backup, { signal: AbortSignal.timeout(8000) });
      const json2 = await res2.json();
      const data2 = JSON.parse(json2.contents);
      const meta2 = data2?.chart?.result?.[0]?.meta;
      if (meta2?.regularMarketPrice) {
        lastKnownPrice = meta2.regularMarketPrice;
        renderLivePrice({
          price:     meta2.regularMarketPrice,
          prevClose: meta2.chartPreviousClose,
          dayHigh:   meta2.regularMarketDayHigh,
          dayLow:    meta2.regularMarketDayLow,
          weekHigh:  meta2.fiftyTwoWeekHigh,
          weekLow:   meta2.fiftyTwoWeekLow,
          volume:    meta2.regularMarketVolume,
          open:      meta2.regularMarketOpen,
          state:     meta2.marketState,
        });
        return meta2.regularMarketPrice;
      }
    } catch(e2) {
      console.warn('Backup proxy also failed:', e2.message);
    }
    showPriceError();
    return null;
  }
}

function renderLivePrice({ price, prevClose, dayHigh, dayLow, weekHigh, weekLow, volume, open, state }) {
  const fmt = v => v != null ? v.toFixed(2) : '--';
  const now = new Date().toLocaleTimeString('de-DE');

  // Main price
  document.getElementById('price-main').textContent = fmt(price);

  // Change vs previous close
  const change = prevClose ? price - prevClose : null;
  const changePct = prevClose ? ((change / prevClose) * 100) : null;
  const changeEl = document.getElementById('price-change');
  if (change !== null) {
    const up = change >= 0;
    changeEl.className = `price-hero-change ${up ? 'up' : 'down'}`;
    changeEl.textContent = `${up ? 'â–²' : 'â–¼'} ${up ? '+' : ''}${fmt(change)} (${up ? '+' : ''}${changePct.toFixed(2)}%) vs prev close`;
  }

  // 52-week range
  document.getElementById('price-52low').textContent = fmt(weekLow);
  document.getElementById('price-52high').textContent = fmt(weekHigh);
  if (weekHigh && weekLow) {
    const pct52 = Math.round(((price - weekLow) / (weekHigh - weekLow)) * 100);
    document.getElementById('price-range-bar').style.width = pct52 + '%';
    document.getElementById('price-range-pos').textContent =
      pct52 < 30 ? 'Near 52-week low' : pct52 > 70 ? 'Near 52-week high' : 'Mid 52-week range';
  }

  // Day range
  document.getElementById('price-daylow').textContent = fmt(dayLow);
  document.getElementById('price-dayhigh').textContent = fmt(dayHigh);
  if (dayHigh && dayLow) {
    const dayPct = Math.round(((price - dayLow) / (dayHigh - dayLow)) * 100);
    document.getElementById('price-day-bar').style.width = dayPct + '%';
  }
  document.getElementById('price-vs-prev').textContent =
    prevClose ? `Prev close: ${fmt(prevClose)}` : '';

  // Previous close / open / volume
  document.getElementById('price-prevclose').textContent = fmt(prevClose);
  document.getElementById('price-open').textContent = `Open: ${fmt(open)}`;
  document.getElementById('price-volume').textContent =
    volume ? `Volume: ${volume.toLocaleString()} contracts` : 'Volume: --';

  // Market state
  const stateLabels = { REGULAR:'ğŸŸ¢ Market Open', PRE:'ğŸŸ¡ Pre-Market', POST:'ğŸŸ¡ After-Hours', CLOSED:'âš« Market Closed' };
  document.getElementById('price-market-state').textContent = stateLabels[state] || state || '--';
  document.getElementById('price-updated').textContent = `Updated: ${now}`;
  document.getElementById('price-freshness').textContent = `Live Â· ${now}`;
  document.getElementById('price-label').textContent = `FCOJ Front Month (OJ=F) Â· ${now}`;

  // Technical levels current price
  document.getElementById('tech-current-price').textContent = `${fmt(price)}Â¢`;
  const techNote = change >= 0 ? 'â–² Rising' : 'â–¼ Falling';
  document.getElementById('tech-price-note').textContent = techNote;

  // Update outlook with live price
  buildOutlook(null, price, change, changePct);
}

function showPriceError() {
  document.getElementById('price-main').textContent = 'N/A';
  document.getElementById('price-change').textContent = 'Price unavailable -- Yahoo Finance unreachable';
  document.getElementById('price-change').className = 'price-hero-change';
  document.getElementById('price-change').style.cssText = 'background:rgba(255,255,255,0.1);color:#ccc';
  document.getElementById('price-freshness').textContent = 'Price feed offline';
  document.getElementById('price-updated').textContent = 'Could not fetch -- retry in 5min';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  NEWS -- OJ-specific from news.json + static
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const OJ_STATIC_NEWS = [
  {
    title: `Brazil orange crop forecast cut again -- 294.81M boxes on greening and drought`,
    summary: `Fundecitrus December 2025 revision: forecast down 6.3% from May 314.6M boxes. Greening severity rose to 22.7%, drop rate at 23% -- highest in 11 harvests. Rainfall 20% below average from May--November.`,
    url: 'https://www.freshfruitportal.com/news/2025/12/12/brazilian-orange/',
    source: 'FreshFruitPortal',
    region: 'Brazil -- SÃ£o Paulo Citrus Belt',
    published: '2025-12-12',
    tag: 'Supply',
    highImpact: true
  },
  {
    title: `February 2026 Fundecitrus update: Drop rate maintained at 23% -- worst in 11 years`,
    summary: `The February 10, 2026 Fundecitrus update maintains fruit drop at 23%, the highest recorded across 11 harvests. Rainfall 10% below historical average. Average fruit weight 153g -- 1g below projection. Final estimate April 10.`,
    url: 'https://citrusindustry.net/2026/02/10/brazilian-orange-forecast-updated/',
    source: 'Citrus Industry Magazine',
    region: 'Brazil',
    published: '2026-02-10',
    tag: 'Supply',
    highImpact: true
  },
  {
    title: `FCOJ Softs Report Feb 19, 2026: Trends mixed to up -- support 186Â¢, resistance 211Â¢`,
    summary: `Florida harvest active but wrapping up. Cold January/February may have caused tree damage -- frozen fruit going to processors. Brazil weather good with scattered showers. Market feels weak demand will continue after last year's high prices.`,
    url: 'https://blog.pricegroup.com/2026/02/19/softs-report-02-19-2026/',
    source: 'Price Group (Jack Scoville)',
    region: 'Global',
    published: '2026-02-19',
    tag: 'Price',
    highImpact: false
  },
  {
    title: `FCOJ price âˆ’42.94% year-over-year despite structural supply deficit -- demand destruction dominant`,
    summary: `After hitting 357Â¢/lb in 2024, FCOJ has fallen sharply to 200Â¢ despite Brazil greening affecting 47.6% of trees and Florida at historic lows. Consumers and manufacturers adjusted to high prices, reducing OJ consumption across EU and US.`,
    url: 'https://www.tradingview.com/symbols/ICEUS-OJ1!/',
    source: 'TradingView / ICE',
    region: 'Global',
    published: '2026-02-19',
    tag: 'Price',
    highImpact: true
  },
  {
    title: `Brazil orange crop forecast: 40% affected by greening -- season output up YoY but below potential`,
    summary: `Fundecitrus reports ~40% of 2025-26 crop affected by citrus greening (HLB). Despite a projected 28% increase vs the poor 2024/25 season, output is still constrained by disease and drought. Greening now reducing productive potential by approximately 35%.`,
    url: 'https://www.freshplaza.com/north-america/article/9789039/brazil-orange-crop-forecast-cut-to-306-7-million-boxes/',
    source: 'FreshPlaza',
    region: 'Brazil',
    published: '2025-11-27',
    tag: 'Supply',
    highImpact: false
  },
  {
    title: `Brazil orange juice exports fell 19.7% in first half of 2024/25 crop`,
    summary: `Brazil OJ exports dropped significantly in H1 2024/25, driven by lower production from 230.87M box season (lowest in years). EU remained primary destination. High prices suppressed buyer demand while supply was scarce.`,
    url: 'https://www.investing.com/commodities/orange-juice',
    source: 'Reuters / Investing.com',
    region: 'Brazil',
    published: '2025-09-01',
    tag: 'Trade',
    highImpact: false
  },
];

function renderOJNews() {
  document.getElementById('oj-news').innerHTML = OJ_STATIC_NEWS.map(a => `
    <div class="news-card${a.highImpact?' high-impact':''}">
      <div class="news-card-hd">
        <span class="news-tag">${a.tag}</span>
        <span class="news-src">${a.source}</span>
      </div>
      <div class="news-body">
        <div class="news-title">${a.title}</div>
        <div class="news-summary">${a.summary}</div>
      </div>
      <div class="news-ft">
        <span class="news-date">ğŸ“ ${a.region} Â· ${a.published}</span>
        <a href="${a.url}" target="_blank" rel="noopener" class="news-link">Read more â†’</a>
      </div>
    </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  CLOCK
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function updateClock() {
  const now = new Date();
  const t = now.toLocaleTimeString('de-DE') + ' Â· ' + now.toLocaleDateString('de-DE');
  document.getElementById('live-time').textContent = t;
  document.getElementById('footer-time').textContent = t;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Fire everything immediately
renderOJNews();
buildOutlook(null, null, null, null);
updateClock();
setInterval(updateClock, 1000);

// Live price -- every 5 minutes
fetchLivePrice();
setInterval(fetchLivePrice, 5 * 60 * 1000);

// Weather -- every 30 minutes
loadWeather();
setInterval(loadWeather, 30 * 60 * 1000);

// TradingView loaded via iframe -- no JS needed
</script>
</body>
</html>
